<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %> - Todo Analytics</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Day.js for date handling -->
    <script src="https://unpkg.com/dayjs@1.11.10/dayjs.min.js"></script>
    
    <!-- Custom styles -->
    <style>
        .task-status-completed { @apply bg-green-100 text-green-800 border-green-200; }
        .task-status-pending { @apply bg-yellow-100 text-yellow-800 border-yellow-200; }
        .task-status-cancelled { @apply bg-red-100 text-red-800 border-red-200; }
        
        .priority-high { @apply bg-red-500; }
        .priority-medium { @apply bg-yellow-500; }
        .priority-low { @apply bg-green-500; }
        
        .flash-success { @apply bg-green-100 border-green-400 text-green-700; }
        .flash-error { @apply bg-red-100 border-red-400 text-red-700; }
        .flash-warning { @apply bg-yellow-100 border-yellow-400 text-yellow-700; }
        .flash-info { @apply bg-blue-100 border-blue-400 text-blue-700; }
        
        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }
        
        .kpi-card {
            @apply bg-white rounded-lg shadow-md p-6 border-l-4;
        }
        
        .kpi-card.primary { @apply border-l-blue-500; }
        .kpi-card.success { @apply border-l-green-500; }
        .kpi-card.warning { @apply border-l-yellow-500; }
        .kpi-card.danger { @apply border-l-red-500; }
        
        .task-item {
            @apply bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-3 hover:shadow-md transition-shadow;
        }
        
        .task-item.overdue {
            @apply border-l-4 border-l-red-500;
        }
        
        .task-item.completed {
            @apply opacity-75;
        }
        
        .btn {
            @apply px-4 py-2 rounded-md font-medium transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2;
        }
        
        .btn-primary {
            @apply bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500;
        }
        
        .btn-success {
            @apply bg-green-600 text-white hover:bg-green-700 focus:ring-green-500;
        }
        
        .btn-warning {
            @apply bg-yellow-600 text-white hover:bg-yellow-700 focus:ring-yellow-500;
        }
        
        .btn-danger {
            @apply bg-red-600 text-white hover:bg-red-700 focus:ring-red-500;
        }
        
        .btn-secondary {
            @apply bg-gray-600 text-white hover:bg-gray-700 focus:ring-gray-500;
        }
        
        .btn-outline {
            @apply border border-gray-300 text-gray-700 hover:bg-gray-50 focus:ring-gray-500;
        }
        
        .form-input {
            @apply block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500;
        }
        
        .form-select {
            @apply block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500;
        }
        
        .form-label {
            @apply block text-sm font-medium text-gray-700 mb-1;
        }
        
        .badge {
            @apply inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium;
        }
        
        .badge-success { @apply bg-green-100 text-green-800; }
        .badge-warning { @apply bg-yellow-100 text-yellow-800; }
        .badge-danger { @apply bg-red-100 text-red-800; }
        .badge-info { @apply bg-blue-100 text-blue-800; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Navigation -->
    <%- include('../partials/nav') %>
    
    <!-- Flash Messages -->
    <%- include('../partials/flash') %>
    
    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <%- body %>
    </main>
    
    <!-- Footer -->
    <footer class="bg-white border-t border-gray-200 mt-12">
        <div class="container mx-auto px-4 py-6">
            <div class="text-center text-gray-600">
                <p>&copy; 2024 Todo Analytics. Built with Node.js, Express, and MongoDB.</p>
            </div>
        </div>
    </footer>
    
    <!-- Custom JavaScript -->
    <script>
        // Auto-hide flash messages after 5 seconds
        document.addEventListener('DOMContentLoaded', function() {
            const flashMessages = document.querySelectorAll('.flash-message');
            flashMessages.forEach(function(message) {
                setTimeout(function() {
                    message.style.transition = 'opacity 0.5s ease-out';
                    message.style.opacity = '0';
                    setTimeout(function() {
                        message.remove();
                    }, 500);
                }, 5000);
            });
            
            // Initialize tooltips and other UI components
            initializeUI();
        });
        
        function initializeUI() {
            // Add any custom UI initialization here
            console.log('UI initialized');
        }
        
        // Utility functions
        function formatDate(dateString) {
            return dayjs(dateString).format('MMM DD, YYYY');
        }
        
        function formatTime(timeString) {
            return dayjs(`2000-01-01 ${timeString}`).format('h:mm A');
        }
        
        function showLoading(element) {
            element.innerHTML = '<div class="flex items-center justify-center"><div class="animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"></div></div>';
        }
        
        function showSuccess(message) {
            const flash = document.createElement('div');
            flash.className = 'flash-message flash-success p-4 mb-4 border rounded-md';
            flash.textContent = message;
            document.querySelector('main').insertBefore(flash, document.querySelector('main').firstChild);
        }
        
        function showError(message) {
            const flash = document.createElement('div');
            flash.className = 'flash-message flash-error p-4 mb-4 border rounded-md';
            flash.textContent = message;
            document.querySelector('main').insertBefore(flash, document.querySelector('main').firstChild);
        }
    </script>
</body>
</html>
